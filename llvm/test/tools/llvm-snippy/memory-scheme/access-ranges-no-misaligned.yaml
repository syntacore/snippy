# RUN: llvm-snippy %s -dump-memory-accesses=%t
# RUN: FileCheck %s --input-file=%t

options:
  march: riscv64-linux-gnu
  num-instrs: 100

sections:
  - no:        1
    VMA:       0x80000000
    SIZE:      0x400000
    LMA:       0x80000000
    ACCESS:    rx
  - no:        2
    VMA:       0x80600000
    SIZE:      0x400000
    LMA:       0x80600000
    ACCESS:    rw

access-ranges:
  - start: 0x80600000
    size: 0x20
    stride: 32
    first-offset: 0
    last-offset: 31
    misaligned-access: false

  - start: 0x80700000
    size: 0x40
    stride: 64
    first-offset: 0
    last-offset: 63

histogram:
  - [LW, 1.0]
  - [SW, 1.0]

# COM: SW and LW have natural alignment of 4 bytes
# COM: In 0x80600000 range only aligned accesses are allowed:
# CHECK-NOT: {{0x806[0-f]{4}[1-3]}}
# CHECK-NOT: {{0x806[0-f]{4}[5-7]}}
# CHECK-NOT: {{0x806[0-f]{4}[9-b]}}
# CHECK-NOT: {{0x806[0-f]{4}[d-f]}}

# COM: In 0x80700000 range misaligned accesses are allowed (default):
# CHECK: {{0x807[0-f]{4}[1-3]}}
# CHECK: {{0x807[0-f]{4}[5-7]}}
# CHECK: {{0x807[0-f]{4}[9-b]}}
# CHECK: {{0x807[0-f]{4}[d-f]}}
