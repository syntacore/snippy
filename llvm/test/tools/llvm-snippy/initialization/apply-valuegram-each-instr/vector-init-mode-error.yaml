# REQUIRES: riscv-rvv
# COM: This test checks that when using modes other than 'loads' we get an error

# RUN: not llvm-snippy %s -valuegram-operands-regs=%S/Inputs/histograms.yaml -rvv-init-mode=mixed  \
# RUN: |& FileCheck %s

# RUN: not llvm-snippy %s -valuegram-operands-regs=%S/Inputs/histograms.yaml -rvv-init-mode=splats \
# RUN: |& FileCheck %s

# RUN: not llvm-snippy %s -valuegram-operands-regs=%S/Inputs/histograms.yaml -rvv-init-mode=slides \
# RUN: |& FileCheck %s

options:
  march: riscv64
  mcpu: generic-rv64
  mattr: +v
  num-instrs: 1
  valuegram-operands-regs-init-outputs: on

sections:
    - no:        0
      VMA:       0x10000
      SIZE:      0x40000
      LMA:       0x10000
      ACCESS:    r
    - no:        1
      VMA:       0x100000
      SIZE:      0x1000000
      LMA:       0x100000
      ACCESS:    rx
    - no:        2
      VMA:       0x2100000
      SIZE:      0x100000
      LMA:       0x2100000
      ACCESS:    rw

riscv-vector-unit:
  mode-change-bias:
    P: 0.001
  mode-distribution:
    VM:
      - [any_legal, 1.0]
    VL:
      - [any_legal, 1.0]
    VXRM:
      rnu: 1.0
    VTYPE:
      SEW:
        sew_32: 1.0
      LMUL:
          m8: 1.0
      VMA:
        mu: 1.0
      VTA:
        tu: 1.0

histogram:
       - [VADD_VV, 1.0]

# CHECK: Currently reinitialization of vector registers requires rvv-init-mode=loads
