# RUN: llvm-snippy %s -model-plugin None --dump-mir=- |& FileCheck %s

options:
  mtriple: riscv64-unknown-elf
  num-instrs: 200
  init-regs-in-elf: on
  honor-target-abi: on
  verify-mi: on 

sections:
  - no:        1
    VMA:       0x210000
    SIZE:      0x100000
    LMA:       0x210000
    ACCESS:    rx
  - no:        2
    VMA:       0x100000
    SIZE:      0x100000
    LMA:       0x100000
    ACCESS:    rw
  - name:      stack
    VMA:       0x400000
    SIZE:      0x100000
    LMA:       0x400000
    ACCESS:    rw

call-graph:
  entry-point: SnippyFunction
  function-list:
    - name: SnippyFunction
      callees:
        - IamExternalFunc
    - name: IamExternalFunc
      external: true

histogram:
    - [ADD, 1.0]
    - [JAL, 0.1]
    - [JALR, 0.1]

# COM: We check that SnippyFunction has tracksRegLiveness
# CHECK: name: SnippyFunction
# CHECK-NEXT: alignment:
# CHECK-NEXT: exposesReturnsTwice:
# CHECK-NEXT: legalized:
# CHECK-NEXT: regBankSelected:
# CHECK-NEXT: selected:
# CHECK-NEXT: failedISel:
# CHECK-NEXT: tracksRegLiveness: true
